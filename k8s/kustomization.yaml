# Main kustomization for complete GRUD deployment
# Uses service-specific overlays instead of direct resources
# Usage: ko resolve -f k8s/ | kubectl apply -f -
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: grud

resources:
  # Namespace
  - namespace.yaml

  # PostgreSQL (CloudNativePG operator must be installed first)
  - postgres/secrets.yaml
  - postgres/student-db.yaml
  - postgres/project-db.yaml

  # Services (using overlays from base templates)
  - student-service
  - project-service

# Common labels for all resources
commonLabels:
  app.kubernetes.io/part-of: grud-system
  app.kubernetes.io/managed-by: kustomize

# Common annotations
commonAnnotations:
  grud.io/version: "1.0.0"
  grud.io/deployed-by: "kustomize"
